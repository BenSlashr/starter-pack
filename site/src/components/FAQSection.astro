---
export interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  items: FAQItem[];
  title?: string;
}

const { items, title = 'Questions frequentes' } = Astro.props;

const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: items.map((item) => ({
    '@type': 'Question',
    name: item.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: item.answer,
    },
  })),
};
---

{items.length > 0 && (
  <section class="mb-12">
    <h2 class="font-display font-700 text-h2 mb-6">{title}</h2>
    <div class="space-y-3">
      {items.map((item) => (
        <details class="group rounded-xl border border-border bg-surface-raised/20 overflow-hidden">
          <summary class="flex items-center justify-between gap-4 px-5 py-4 cursor-pointer text-sm font-medium text-text-primary hover:text-primary transition-colors list-none [&::-webkit-details-marker]:hidden">
            <span>{item.question}</span>
            <svg class="w-4 h-4 shrink-0 text-text-muted transition-transform group-open:rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <div class="px-5 pb-4 text-sm text-text-secondary leading-relaxed">
            {item.answer}
          </div>
        </details>
      ))}
    </div>
    <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
  </section>
)}
